# TKA Fade Animation System üé≠\n\n## Overview\n\nThe TKA Fade Animation System provides smooth, beautiful crossfade transitions throughout the web application, ported from the desktop app's fade manager architecture. It handles both main tab transitions (Construct ‚Üî Browse ‚Üî Sequence Card ‚Üî Write ‚Üî Learn) and sub-tab transitions within the Construct tab (Build ‚Üî Generate ‚Üî Edit ‚Üî Export).\n\n## üöÄ Features\n\n- **Main Tab Transitions**: Smooth crossfades between major application sections\n- **Sub-tab Transitions**: Beautiful animations within the Construct tab\n- **User Configurable**: Enable/disable animations and adjust timing via settings\n- **Performance Optimized**: GPU-accelerated animations with fallbacks\n- **Accessibility Friendly**: Respects `prefers-reduced-motion` settings\n- **Debug Support**: Built-in debugging tools for developers\n- **State Management**: Full integration with Svelte 5 runes\n\n## üèóÔ∏è Architecture\n\n### Core Components\n\n1. **FadeOrchestrator** (`fadeOrchestrator.ts`)\n - Central coordinator for all fade operations\n - Manages transition state and timing\n - Handles events and callbacks\n\n2. **Custom Transitions** (`transitions.ts`)\n - Svelte transition functions\n - `enhancedFade`, `slideFade`, `scaleFade`, `fluidTransition`\n - Pre-configured transition instances\n\n3. **State Management** (`fadeState.svelte.ts`)\n - Svelte 5 runes-based reactive state\n - Integration with app state\n - Transition coordination\n\n4. **Type Definitions** (`fadeTypes.ts`)\n - TypeScript interfaces for all fade operations\n - Configuration objects and state types\n\n## üì¶ Installation & Setup\n\nThe fade system is automatically initialized when the app starts:\n\n`javascript\n// Automatic initialization in bootstrap.ts\nimport { initializeFadeOrchestrator } from '$services/ui/animation';\n\nconst fadeOrchestrator = initializeFadeOrchestrator({\n  duration: 300,\n  delay: 0\n});\n`\n\n## üéØ Usage\n\n### Basic Tab Transitions\n\n`svelte\n<!-- MainInterface.svelte -->\n<script>\n  import { fluidTransition } from '$services/ui/animation';\n  \n  function getTabInTransition(tabId) {\n    return (node) => fluidTransition(node, {\n      duration: 350,\n      effects: ['fade', 'slide'],\n      slideDirection: 'right',\n      distance: 30,\n      opacity: { start: 0, end: 1 }\n    });\n  }\n</script>\n\n{#if isTabActive('construct')}\n  <div \n    class=\"tab-content\" \n    in:getTabInTransition('construct')\n    out:getTabOutTransition('construct')\n  >\n    <ConstructTab />\n  </div>\n{/if}\n`\n\n### Programmatic Transitions\n\n`javascript\nimport { \n  transitionToMainTab, \n  completeMainTabTransition,\n  transitionToSubTab,\n  completeSubTabTransition \n} from '$services/ui/animation';\n\n// Main tab transition\nconst transitionId = await transitionToMainTab('construct', 'browse');\nif (transitionId) {\n  // Update UI state\n  setTimeout(() => {\n    completeMainTabTransition(transitionId);\n  }, 50);\n}\n\n// Sub-tab transition\nconst subTransitionId = await transitionToSubTab('build', 'generate');\nif (subTransitionId) {\n  // Update sub-tab state\n  setTimeout(() => {\n    completeSubTabTransition(subTransitionId, 'build', 'generate');\n  }, 50);\n}\n`\n\n### State Monitoring\n\n`javascript\nimport { \n  isMainTabTransitioning, \n  isSubTabTransitioning,\n  getMainTabTransition,\n  getSubTabTransition \n} from '$services/ui/animation';\n\n// Check if transitions are active\nlet isTransitioning = $derived(isMainTabTransitioning());\nlet transitionState = $derived(getMainTabTransition());\n\n// Use in templates for visual feedback\n{#if isTransitioning}\n  <div class=\"transition-indicator\">\n    üé≠ Transitioning: {transitionState.fromTab} ‚Üí {transitionState.toTab}\n  </div>\n{/if}\n`\n\n## ‚öôÔ∏è Configuration\n\n### User Settings\n\nUsers can control fade animations via the Settings dialog:\n\n- **Enable/Disable**: Toggle fade animations on/off\n- **Main Tab Duration**: Timing for major tab transitions (100-1000ms)\n- **Sub-tab Duration**: Timing for construct sub-tab transitions (100-1000ms)\n- **Debug Tools**: Console logging for developers\n\n### Developer Configuration\n\n`javascript\nimport { updateFadeSettings, setFadeEnabled } from '$services/ui/animation';\n\n// Update timing globally\nupdateFadeSettings({\n  mainTabDuration: 400,\n  subTabDuration: 200,\n  globalDuration: 300\n});\n\n// Enable/disable programmatically\nsetFadeEnabled(false);\n`\n\n## üé® Custom Transitions\n\n### Creating Custom Effects\n\n`javascript\nimport { fluidTransition } from '$services/ui/animation';\n\n// Custom bounce effect\nfunction bounceTransition(node) {\n  return fluidTransition(node, {\n    duration: 500,\n    effects: ['fade', 'scale'],\n    scale: { start: 0.8, end: 1.2 },\n    opacity: { start: 0, end: 1 }\n  });\n}\n\n// Custom slide combinations\nfunction diagonalSlide(node) {\n  return fluidTransition(node, {\n    duration: 300,\n    effects: ['fade', 'slide'],\n    slideDirection: 'right',\n    distance: 100\n  });\n}\n`\n\n### Transition Utilities\n\n`javascript\nimport { fadeUtils } from '$services/ui/animation';\n\n// Quick fade pair\nconst { in: fadeIn, out: fadeOut } = fadeUtils.createFadePair(250);\n\n// Slide fade pair\nconst { in: slideIn, out: slideOut } = fadeUtils.createSlideFadePair('left', 300);\n\n// Keyed crossfade\nconst { send, receive } = fadeUtils.createKeyedCrossfade(400);\n`\n\n## üîß Debugging\n\n### Debug Information\n\n`javascript\nimport { getFadeDebugInfo } from '$services/ui/animation';\n\n// Get current system state\nconst debugInfo = getFadeDebugInfo();\nconsole.log('Fade System Debug:', debugInfo);\n\n// Output:\n// {\n//   isInitialized: true,\n//   settings: { enabled: true, mainTabDuration: 350, ... },\n//   mainTabTransition: { isTransitioning: false, ... },\n//   subTabTransition: { isTransitioning: false, ... },\n//   orchestrator: { isEnabled: true, activeOperationsCount: 0, ... }\n// }\n`\n\n### Console Tools\n\nThe settings dialog includes a \"Debug Fade System\" button that logs comprehensive information to the browser console.\n\n### Visual Indicators\n\n- **Navigation Bar**: Shows üé≠ emoji when fade system is enabled\n- **Transition Indicators**: Animated spinners during active transitions\n- **Debug Overlays**: Optional visual feedback (can be disabled in production)\n\n## üéØ Best Practices\n\n### Performance\n\n1. **Use GPU Acceleration**: Animations automatically use `transform` and `opacity`\n2. **Limit Concurrent Transitions**: System prevents overlapping main tab transitions\n3. **Respect User Preferences**: Automatically disables for `prefers-reduced-motion`\n\n### Accessibility\n\n1. **Reduced Motion**: Full support for accessibility preferences\n2. **Focus Management**: Maintains proper focus during transitions\n3. **Screen Readers**: Doesn't interfere with assistive technology\n\n### Development\n\n1. **Error Handling**: All fade operations include try-catch blocks\n2. **Graceful Degradation**: Falls back to instant transitions if system fails\n3. **TypeScript**: Full type safety for all fade operations\n\n## üîç Troubleshooting\n\n### Common Issues\n\n**Transitions Not Working**\n`javascript\n// Check if fade system is enabled\nimport { isFadeEnabled, getFadeDebugInfo } from '$services/ui/animation';\n\nconsole.log('Fade enabled:', isFadeEnabled());\nconsole.log('Debug info:', getFadeDebugInfo());\n`\n\n**Slow Performance**\n`css\n/* Ensure GPU acceleration is enabled */\n.tab-content {\n  transform: translateZ(0);\n  backface-visibility: hidden;\n}\n`\n\n**State Synchronization Issues**\n`javascript\n// Reset the fade system if needed\nimport { resetFadeSystem } from '$services/ui/animation';\nresetFadeSystem();\n`\n\n### Testing\n\nRun the included test script:\n`bash\nnode test-fade-system.js\n`\n\n## üìö API Reference\n\n### Core Functions\n\n- `initializeFadeSystem(config)` - Initialize the fade system\n- `transitionToMainTab(from, to)` - Start main tab transition\n- `transitionToSubTab(from, to)` - Start sub-tab transition\n- `setFadeEnabled(enabled)` - Enable/disable system\n- `updateFadeSettings(settings)` - Update configuration\n- `getFadeDebugInfo()` - Get debug information\n- `resetFadeSystem()` - Reset to initial state\n\n### Transition Functions\n\n- `enhancedFade(node, config)` - Basic fade transition\n- `slideFade(node, config)` - Slide + fade combination\n- `scaleFade(node, config)` - Scale + fade combination\n- `fluidTransition(node, config)` - Multi-effect transition\n\n### State Getters\n\n- `isFadeEnabled()` - Check if system is enabled\n- `isMainTabTransitioning()` - Check main tab state\n- `isSubTabTransitioning()` - Check sub-tab state\n- `getMainTabTransition()` - Get main tab transition details\n- `getSubTabTransition()` - Get sub-tab transition details\n\n## ü§ù Contributing\n\nWhen adding new transitions:\n\n1. Follow the existing naming convention\n2. Include TypeScript types\n3. Add error handling\n4. Test with reduced motion preferences\n5. Update this documentation\n\n## üìÑ License\n\nPart of the TKA (The Kinetic Constructor) project.\n
