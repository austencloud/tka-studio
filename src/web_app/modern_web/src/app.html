<!doctype html>
<html lang="en">
	<head>
		<meta charset="utf-8" />
		<link rel="icon" href="%sveltekit.assets%/favicon.png" />
		<meta name="viewport" content="width=device-width, initial-scale=1" />
		<meta name="description" content="TKA - The Kinetic Constructor V2 Modern" />
		<meta name="theme-color" content="#1a1a1a" />

		<!-- CONSOLE FORWARDER - MUST BE FIRST -->
		<script>
			(function() {
				// Store original console methods immediately
				const originalConsole = {
					log: console.log,
					error: console.error,
					warn: console.warn,
					info: console.info
				};

				// Send to server
				function sendToServer(level, args) {
					const message = args.map(arg => {
						if (typeof arg === 'object') {
							try {
								return JSON.stringify(arg, null, 2);
							} catch {
								return String(arg);
							}
						}
						return String(arg);
					}).join(' ');

					fetch('/api/console-forward', {
						method: 'POST',
						headers: { 'Content-Type': 'application/json' },
						body: JSON.stringify({ level, message })
					}).catch(() => {}); // Ignore fetch errors
				}

				// Override console methods immediately
				console.log = function(...args) {
					originalConsole.log.apply(console, args);
					sendToServer('LOG', args);
				};

				console.error = function(...args) {
					originalConsole.error.apply(console, args);
					sendToServer('ERROR', args);
				};

				console.warn = function(...args) {
					originalConsole.warn.apply(console, args);
					sendToServer('WARN', args);
				};

				console.info = function(...args) {
					originalConsole.info.apply(console, args);
					sendToServer('INFO', args);
				};

				// Capture global errors
				window.addEventListener('error', function(event) {
					console.error('ðŸš¨ GLOBAL ERROR:', {
						message: event.message,
						filename: event.filename,
						line: event.lineno,
						column: event.colno,
						stack: event.error?.stack
					});
				});

				window.addEventListener('unhandledrejection', function(event) {
					console.error('ðŸš¨ UNHANDLED PROMISE REJECTION:', event.reason);
				});
			})();
		</script>

		<!-- Preload critical fonts if needed -->
		<!-- <link rel="preload" href="/fonts/inter.woff2" as="font" type="font/woff2" crossorigin> -->

		%sveltekit.head%
	</head>
	<body data-sveltekit-preload-data="hover" class="bg-background text-foreground">
		<div style="display: contents">%sveltekit.body%</div>
	</body>
</html>
