# TKA User Flows - Automated Playwright Tests

This directory contains recorded user flows for The Kinetic Alphabet app. These flows can be run to test critical user journeys or used as regression tests.

## Flows Recorded

1. **Complete Construct Flow** - Manual sequence building (start → beats → play → edit → clear)
2. **Generate Flow** - Auto-creation with parameter toggling
3. **Share/Export Flow** - GIF export functionality
4. **Advanced Start Position Picker** - Access all 16 position variations
5. **Learn Drills Flow** - Educational flashcard quizzes
6. **Library Save & Reload Flow** - Sequence persistence testing
7. **Mobile PWA Install Flow** - Progressive Web App installation on mobile

## Running the Flows

### Run All Flows

```bash
npm run flows
```

### Run a Specific Flow

```bash
npx playwright test flows/1-construct-flow.spec.ts
npx playwright test flows/2-generate-flow.spec.ts
npx playwright test flows/3-share-export-flow.spec.ts
# ... etc
```

### Run with UI (Headed Mode)

```bash
npx playwright test flows/1-construct-flow.spec.ts --headed
```

### Run with Debug Inspector

```bash
npx playwright test flows/1-construct-flow.spec.ts --debug
```

## Prerequisites

1. **App must be running** on `http://localhost:5173`

   ```bash
   npm run dev
   ```

2. **Playwright must be installed**
   ```bash
   npm install -D @playwright/test
   npx playwright install
   ```

## Voice Commands (for AI Agents)

Once these flows are set up, you can tell your AI agent:

- _"Run the construct flow"_ → Tests manual sequence building
- _"Run the generate flow"_ → Tests auto-generation
- _"Run all flows"_ → Full regression test
- _"Run flows in headed mode"_ → Watch the tests execute

## Customization

Each flow is a standard Playwright test file. You can:

- Modify selectors if UI changes
- Add assertions to verify behavior
- Extend flows with additional steps
- Create new flows by copying existing patterns

## Test Structure

All flows follow this pattern:

```typescript
test("Flow Name", async ({ page }) => {
  // 1. Navigate to app
  await page.goto("http://localhost:5173");

  // 2. Interact with UI
  await page.click("...");

  // 3. Assert expected behavior
  await expect(page.locator("...")).toBeVisible();
});
```

## Troubleshooting

### Flow fails with "Element not found"

- UI may have changed - update selectors in the spec file
- App may not have loaded - increase `waitForTimeout` values

### Download tests fail

- Check browser download permissions
- Verify export functionality is working in the app

### Mobile flow doesn't trigger install prompt

- PWA prompts require HTTPS in production
- May need to simulate install event manually

## Next Steps

1. **Add to CI/CD** - Run flows on every commit
2. **Generate reports** - Use Playwright's HTML reporter
3. **Add screenshots** - Capture evidence of successful flows
4. **Expand coverage** - Record additional edge cases

---

**Generated by Claude Code** - AI-powered flow recording for The Kinetic Alphabet
