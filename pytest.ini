[pytest]
# TKA Monorepo pytest configuration


# Qt API auto-detection (pytest-qt will detect PyQt6 automatically)

addopts =
    -v
    --tb=short
    --disable-warnings
    --maxfail=1000
    --strict-markers
    --strict-config
    --capture=no
    --continue-on-collection-errors
    --ignore=launcher/tests/test_hover_functionality.py
    --ignore=launcher/tests/test_reliable_styling.py

# Python path - comprehensive setup for monorepo
# Order matters: more specific paths first
pythonpath =
    .
    src
    src/desktop/modern/src
    src/desktop/modern
    src/desktop/legacy/src
    src/desktop/legacy
    launcher
    data
    packages/shared-types/python
    packages/constants/python
    packages
    assets

# Test discovery - comprehensive across all applications
testpaths =
    .
    src/desktop/modern/tests
    src/desktop/legacy/tests
    launcher/tests

python_files = test_*.py *_test.py
python_functions = test_*
python_classes = Test*

# Comprehensive markers for TKA monorepo
markers =
    unit: Unit tests (fast, isolated)
    integration: Integration tests (component interactions)
    specification: Specification tests (requirements verification)
    regression: Regression tests (bug prevention)
    ui: User interface tests (with pytest-qt)
    gui: GUI tests requiring display
    modern: Modern codebase tests
    legacy: Legacy codebase tests
    desktop: Desktop application tests
    web: Web application tests
    launcher: Launcher application tests
    slow: Tests taking >5 seconds
    broken: Known broken tests (temporary)
    critical: Critical functionality tests
    skip_if_no_pyqt6: Skip if PyQt6 unavailable
    requires_server: Tests that need a running server

minversion = 6.0

# Clean output - filter common warnings
filterwarnings =
    ignore::DeprecationWarning
    ignore::PendingDeprecationWarning
    ignore::UserWarning
    ignore::ImportWarning
    ignore::pytest.PytestDeprecationWarning
    ignore::RuntimeWarning

# Async support
asyncio_mode = auto
asyncio_default_fixture_loop_scope = function
